<div class="container-fluid">
    <div data-ng-show="app.authorization.hasPermission('seed-w20', ['seed', 'i18n', 'locale', 'read']) && app.authentication.isAuthentifiable()">
        <div class="row">
            <div class="col-md-12">
                <h1 class="page-header">{{ "application.view.seed-i18n.title" | localize }}</h1>
            </div>
            <div class="col-md-12">
                <div data-tabset id="menu">
                    <div data-tab data-heading="{{ 'application.view.seed-i18n.settings' | localize }}">
                        <div id="dashboard" data-ng-include data-src="'/dashboardTemplate.html'" data-ng-controller="SeedI18nDashboardController"></div>
                    </div>
                    <div data-tab data-active="true" data-heading="{{ 'application.view.seed-i18n.keys' | localize }}">
                        <div id="key-management" data-ng-include data-src="'/keyManagementTemplate.html'" data-ng-controller="SeedI18nKeysController"></div>
                    </div>
                    <div data-tab data-heading="{{ 'application.view.seed-i18n.translate' | localize }}">

                    </div>
                    <div data-tab data-heading="{{ 'application.view.seed-i18n.statistic' | localize }}">

                    </div>
                </div>
            </div>
        </div>
        <div class="alert alert-warning"
             data-ng-show="!app.authorization.hasPermission('seed-w20', ['seed', 'i18n', 'locale', 'write']) && app.authentication.isAuthentifiable()">
            {{ "application.view.seed-i18n.no-edit-permission" | localize }}
        </div>
    </div>
</div>

<script type="text/ng-template" id="/dashboardTemplate.html">
    <br>
    <div class="row">
        <div class="col-sm-3">
            <div id="default-language" class="form-group">
                <label>{{ "application.view.seed-i18n.default-language" | localize }}</label>
                <select class="form-control"
                        data-ng-disabled="!app.authorization.hasPermission('seed-w20', ['seed', 'i18n', 'locale', 'write']) && app.authentication.isAuthentifiable()"
                        data-ng-options="lang.englishLanguage for lang in app.applicationLocales | orderBy:'toString()'"
                        data-ng-model="app.defaultLocale"
                        data-ng-change="locales.updateDefault()">
                </select>
            </div>
            <div id="application-locales" class="form-group">
                <label>{{ "application.view.seed-i18n.application-languages" | localize }}</label>
                <ul class="list-group">
                    <li data-ng-repeat="availableLocale in app.applicationLocales | orderBy:'availableLocale.englishLanguage'"
                        class="list-group-item">
                        {{ availableLocale.englishLanguage }} ({{ availableLocale.code }})
                        <button title="Remove" class="pull-right btn btn-xs btn-default"
                                data-ng-click="locales.remove(availableLocale)">
                            <i class="fa fa-times"></i>
                        </button>
                    </li>
                </ul>
                <button class="btn btn-default" data-ng-show="!addNewLanguage"
                        data-ng-click="addNewLanguage = !addNewLanguage">
                    {{ "application.view.seed-i18n.add" | localize }} <i class="fa fa-plus"></i>
                </button>
            </div>
        </div>
        <div id="new-language" class="form-group col-sm-9" data-ng-show="addNewLanguage">
            <label>{{ "application.view.seed-i18n.languages-to-add" | localize }}</label>
            <input class="form-control" type="search" data-ng-model="searchLocales"
                   placeholder="{{ 'application.view.seed-i18n.search' | localize }}"
                   data-results="0">
            <br>
            <ul class="list-group" style="height: 500px; overflow-y: scroll">
                <li data-ng-repeat="locale in locales.allLocales | filter:searchLocales | orderBy:'locale.englishLanguage'"
                    data-ng-click="locales.add(locale)"
                    class="list-group-item"
                    style="cursor: pointer">
                    <span>
                        <i class="fa fa-plus"></i>
                    </span>
                    {{ locale.englishLanguage }} ({{ locale.code }})
                </li>
            </ul>
        </div>
    </div>
</script>

<script type="text/ng-template" id="/keyManagementTemplate.html">
    <br>
    <div class="row" data-ng-hide="addingNewKey">
        <div class="col-md-8">
            <div class="col-sm-6" style="padding-left: 0;">
                <div id="search-area" class="form-group input-group">
                    <span class="input-group-addon"><i class="fa fa-search"></i></span>
                    <input type="search"
                           placeholder="{{ 'application.view.seed-i18n.searchkeys' | localize }}"
                           data-results="0"
                           class="form-control">
                </div>
            </div>
            <div id="options-area" class="col-sm-6" style="padding-left: 0; padding-right: 0;">
                <div class="btn-group">
                    <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        {{ app.sourceLocale.englishLanguage }} <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu">
                        <li data-ng-repeat="locale in app.applicationLocales">
                            <a href="" data-ng-click="keys.setSourceLocale(locale)">{{ locale.englishLanguage }}</a>
                        </li>
                    </ul>
                </div>
                <button data-ng-init="addingNewKey = false" data-ng-click="addingNewKey = !addingNewKey" class="btn btn-default">
                    <i class="fa fa-plus"></i> {{ "application.view.seed-i18n.add-new-key" | localize }}
                </button>
                <div class="btn-group pull-right" data-ng-init="showTranslations = true; showComments = true">
                    <a class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="fa fa-cog"></i>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            <a href="" data-ng-click="showTranslations = !showTranslations">
                                <i data-ng-show="showTranslations" class="fa fa-check"></i> Show translations
                            </a>
                        </li>
                        <li>
                            <a href="" data-ng-click="showComments = !showComments">
                                <i data-ng-show="showComments" class="fa fa-check"></i> Show comments
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <br>
        </div>
    </div>
    <div id="keys-list" data-ng-hide="addingNewKey" class="row">
        <div class="col-md-8">
            <div id="keys-not-found-message" class="alert alert-warning" data-ng-show="keys.emptyList">
                <i class="fa fa-warning"></i> {{ "application.view.seed-i18n.no-keys-retrieved" | localize }}
            </div>
            <div class="panel panel-default" data-ng-repeat="key in keys.list | orderBy: 'key.name'">
                <div class="panel-heading">
                    <i class="fa fa-key"></i> {{ key.name }}
                    <button class="pull-right btn btn-xs btn-default" style="margin-left: 5px"><i class="fa fa-pencil"></i></button>
                    <button data-ng-show="key.comment && !showComments"
                            data-ng-click="showComment = !showComment"
                            class="pull-right btn btn-xs btn-default"
                            style="margin-left: 5px">
                        <i class="fa fa-comment-o"></i>
                    </button>
                    <button data-ng-click="showTranslation = !showTranslation"
                            data-ng-show="!showTranslations"
                            class="pull-right btn btn-xs btn-default"
                            style="margin-left: 5px">
                        <i data-ng-class="{'fa fa-chevron-up': showTranslation, 'fa fa-chevron-down': !showTranslation}"></i>
                    </button>
                    <div data-w20-confirm="keys.delete(key)" class="pull-right"></div>
                </div>
                <div class="panel-body" data-ng-show="showTranslations || showTranslation">
                    <p>
                        {{ key.translation }}
                    </p>
                    <div data-ng-show="key.comment && (showComments || showComment)" class="alert alert-info" role="alert">
                        <i class="fa fa-comment-o"></i> {{ key.comment }}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="new-key" data-ng-show="addingNewKey" class="row">
        <div class="col-md-8">
            <h4>
                {{  "application.view.seed-i18n.addkeytitle" | localize }}
            </h4>
            <button class="btn btn-default btn-sm pull-right" data-ng-click="addingNewKey = false">
                <i class="fa fa-times"></i> {{ "application.view.seed-i18n.cancel" | localize }}
            </button>
            <br><br>
            <div  class="panel panel-default">
                <div class="panel-heading">
                    <div class="form-inline">
                        <div class="form-group">
                            <label><i class="fa fa-key"></i></label>
                            <input type="text" class="form-control" placeholder="{{ 'application.view.seed-i18n.key-name' | localize }}">
                        </div>
                    </div>
                </div>
                <div class="panel-body">
                    <div class="btn-group">
                        <div class="button-group">
                            <button type="button" class="btn btn-default btn-sm dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-plus"></i> Add translations <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu">
                                <li data-ng-repeat="locale in app.applicationLocales | filter:withoutDefault" data-w20-dropdown-blur>
                                    <a data-ng-click="locale._selected = !locale._selected" href="" class="small" tabIndex="-1">
                                        <i data-ng-show="locale._selected" class="fa fa-check"></i> {{ locale.englishLanguage }}
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <br><br>
                    <div class="form-group">
                        <label>{{ 'application.view.seed-i18n.default-translation' | localize }} ({{ app.defaultLocale.englishLanguage }})</label>
                        <textarea class="form-control" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <div data-ng-repeat="locale in app.applicationLocales | filter:{_selected: true}" class="form-group">
                            <label>{{ locale.englishLanguage }}</label>
                            <textarea class="form-control" rows="3"></textarea>
                        </div>
                    </div>
                    <div class="form-group">
                        <textarea class="form-control" rows="3" placeholder="{{ 'application.view.seed-i18n.comment' | localize }}"></textarea>
                    </div>
                </div>
            </div>
            <div class="form-inline">
                <div class="form-group pull-right">
                    <button class="btn btn-default btn-sm"><i class="fa fa-plus-square-o"></i> {{  "application.view.seed-i18n.saveandnew" | localize }}</button>
                    <button class="btn btn-success btn-sm"><i class="fa fa-plus"></i> {{ "application.view.seed-i18n.save" | localize }}</button>
                </div>
            </div>
        </div>
    </div>
</script>
